<!DOCTYPE html>
<html lang="ja">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>ララベルの依存性注入(DI)コンテナ :: Hwajin&#39;s Blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Laravelの根幹である依存性注入と、これを構成するIoC Containerを見てみましょう。" />
<meta name="keywords" content="laravel" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="http://localhost:1313/ja/posts/2018/07/04/laravel-dependency-injection-container/" />


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-LJWJ9LNV2L"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-LJWJ9LNV2L');
        }
      </script>



  
  <link rel="stylesheet" href="http://localhost:1313/css/buttons.min.59dc4f2d2a85e5583335a503eafe389c3a2214114a6ae46d2d35f08a1277abcc.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/code.min.00125962708925857e7b66dbc58391d55be1191a3d0ce2034de8c9cd2c481c36.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/fonts.min.90c955c31dd7c0e05aae3d4f583d4d8a2af799d69c961337eaf2a825063a55dd.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/footer.min.bcfa5020d45c21f5afeedb4b6bf62e24324dbcd1aacf4dd9e43cf9d9ee3c7b5e.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/header.min.3ef6e703277b9dcc3fc86696911056f11198257c1b87986052e84d529386f740.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/main.min.18ffdec748d6bc5c603406ee515068bc2b15922f41fb64a2a5c2fe2551276bf8.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/menu.min.33e84c2923befc8a99f25a35d3b7d46e75fc2a1fd84c059465d61fb39c7b1551.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/post.min.6c581db9684943a277130aac4d81ec810b4e7059354cf165dfb3b49897452440.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/prism.min.ca6800ca3dc6b21843a1efbd3f4d2dc4346b440a7455693432ba4775135292a1.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/syntax.min.962669087b6f54db2dc27d75f1740fba3b9a2d59a5b5fbc2462361f02a37496c.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/terminal.min.b5044bd5f9e1cd572bab8eba76fe81b84e8d388d0d4d2f19c0f7dde675815ac6.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="http://localhost:1313/favicon.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="ja" />
<meta property="og:type" content="article" />
<meta property="og:title" content="ララベルの依存性注入(DI)コンテナ">
<meta property="og:description" content="Laravelの根幹である依存性注入と、これを構成するIoC Containerを見てみましょう。" />
<meta property="og:url" content="http://localhost:1313/ja/posts/2018/07/04/laravel-dependency-injection-container/" />
<meta property="og:site_name" content="Hwajin&#39;s Blog" />

  
  
  <meta property="og:image" content="https://github.com/user-attachments/assets/237e5002-7845-4618-ac13-a7ca58079792">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2018-07-04 15:00:00 &#43;0000 UTC" />









<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)']]                  
    }
  };
</script>
<meta name="naver-site-verification" content="04189f3919dcbb9325a69d0fa37208e850615030" />


</head>
<body>


<div class="container">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Hwajin&#39;s Blog
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/ja/about">About</a></li>
        
      
        
          <li><a href="https://github.com/hwajin-me">Github</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/hwajin-me/">Linkedin</a></li>
        
      
      
        <hr />
        
          <li>
            <a href="http://localhost:1313/ja/">🇯🇵 Japanese</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/ko/">🇰🇷 Korean</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/en/">🇺🇸 English</a>
          </li>
        
      
    </ul>
  </li>
</ul>

    
    
      <ul class="menu menu--desktop menu--language-selector">
  <li class="menu__trigger">🇯🇵 Japanese&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        <li><a href="http://localhost:1313/ja/">🇯🇵 Japanese</a></li>
      
        <li><a href="http://localhost:1313/ko/">🇰🇷 Korean</a></li>
      
        <li><a href="http://localhost:1313/en/">🇺🇸 English</a></li>
      
    </ul>
  </li>
</ul>

    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/ja/about" >About</a></li>
        
      
        
          <li><a href="https://github.com/hwajin-me" >Github</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/hwajin-me/" >Linkedin</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="http://localhost:1313/ja/posts/2018/07/04/laravel-dependency-injection-container/">ララベルの依存性注入(DI)コンテナ</a>
  </h1>
  <div class="post-meta"><time class="post-date">2018-07-04</time><span class="post-author">Hwajin Lee</span><span class="post-reading-time">11 min read (2290 words)</span>
        <a href="/ko/posts/2018/07/04/laravel-dependency-injection-container/">🇰🇷 Korean</a>
      </div>
  
  
    <span class="post-tags">
      
      #<a href="http://localhost:1313/ja/tags/development/">development</a>&nbsp;
      
      #<a href="http://localhost:1313/ja/tags/laravel/">laravel</a>&nbsp;
      
      #<a href="http://localhost:1313/ja/tags/%E3%83%A9%E3%83%A9%E3%83%99%E3%83%AB/">ララベル</a>&nbsp;
      
    </span>
  
  
  <img src="https://github.com/user-attachments/assets/237e5002-7845-4618-ac13-a7ca58079792"
    class="post-cover"
    alt="ララベルの依存性注入(DI)コンテナ"
    title="Cover Image" />


  
    <div class="post-description">
      Laravelの根幹である依存性注入と、これを構成するIoC Containerを見てみましょう。
    </div>
    <div class="table-of-contents">
      <h2>
        Table of Contents
      </h2>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#의존성-주입이란">의존성 주입이란</a></li>
    <li><a href="#컨테이너-접근">컨테이너 접근</a>
      <ul>
        <li><a href="#외부에서-illuminatecontainer-를-사용">외부에서 Illuminate\Container 를 사용</a></li>
        <li><a href="#기본적인-사용법">기본적인 사용법</a></li>
        <li><a href="#실용적인-예제">실용적인 예제</a></li>
      </ul>
    </li>
    <li><a href="#구현-객체에-인터페이스를-바인딩-하는-법">구현 객체에 인터페이스를 바인딩 하는 법</a>
      <ul>
        <li><a href="#실용적인-예제-1">실용적인 예제</a></li>
      </ul>
    </li>
    <li><a href="#추상--구상-클래스-바인딩">추상 &amp; 구상 클래스 바인딩</a></li>
    <li><a href="#커스텀-바인딩">커스텀 바인딩</a>
      <ul>
        <li><a href="#콜백-해결-컨테이너-이벤트httpslaravelkrdocs56containercontainer-events">콜백 해결 <a href="https://laravel.kr/docs/5.6/container#container-events">(컨테이너 이벤트)</a></a></li>
        <li><a href="#클래스-확장-바인딩-확장httpslaravelkrdocs56containerextending-bindings">클래스 확장 <a href="https://laravel.kr/docs/5.6/container#extending-bindings">(바인딩 확장)</a></a></li>
      </ul>
    </li>
    <li><a href="#싱글톤">싱글톤</a></li>
    <li><a href="#임의의-바인딩-이름">임의의 바인딩 이름</a></li>
    <li><a href="#임의의-값-저장">임의의 값 저장</a></li>
    <li><a href="#함수와-메소드의-의존성-주입">함수와 메소드의 의존성 주입</a>
      <ul>
        <li></li>
        <li><a href="#인스턴스-메소드-호출을-위한-손쉬운-방법">인스턴스 메소드 호출을 위한 손쉬운 방법</a></li>
        <li><a href="#메소드-호출-바인딩">메소드 호출 바인딩</a></li>
      </ul>
    </li>
    <li><a href="#문맥에-따른-조건적-바인딩">문맥에 따른 조건적 바인딩</a>
      <ul>
        <li><a href="#기본-타입-바인딩">기본 타입 바인딩</a></li>
      </ul>
    </li>
    <li><a href="#태깅-tagginghttpslaravelkrdocs56containertagging">태깅 <a href="https://laravel.kr/docs/5.6/container#tagging">(Tagging)</a></a></li>
    <li><a href="#재바인딩-rebinding">재바인딩 (Rebinding)</a>
      <ul>
        <li><a href="#refresh">refresh()</a></li>
      </ul>
    </li>
    <li><a href="#생성자-매개-변수-오버라이딩">생성자 매개 변수 오버라이딩</a></li>
    <li><a href="#그-외-메소드">그 외 메소드</a>
      <ul>
        <li><a href="#bound">bound()</a></li>
        <li><a href="#bindif">bindIf()</a></li>
        <li><a href="#resolved">resolved()</a></li>
        <li><a href="#factory">factory()</a></li>
        <li><a href="#wrap">wrap()</a></li>
        <li><a href="#afterresolving">afterResolving()</a></li>
        <li><a href="#마지막으로">마지막으로..</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
  

  <div class="post-content"><div>
        <p><a href="https://laravel.kr/">Laravel</a> 의 제어의 역전(Inversion of Control) / 의존성 주입 (Dependency Injection) 컨테이너는 매우 강력한 기능입니다. 안타깝게도, 라라벨의 <a href="https://laravel.kr/docs/5.6/">공식 문서</a>는 이 기능의 모든 면을 설명하고 있지 않습니다. 그런 이유로 저는 직접 이 기능들을 실험하여 본 문서를 작성했습니다. 이 문서는 <a href="https://github.com/laravel/framework/tree/5.4/src/Illuminate/Container">Laravel 5.4.26</a> 버전을 기준으로 작성되었으며, 그 외 버전은 기능이 다를 수 있습니다. <strong>이 문서는 번역되었습니다.</strong> <em>번역한 문서는 <a href="https://gist.github.com/davejamesmiller/bd857d9b0ac895df7604dd2e63b23afe">이곳</a>을 클릭하시면 이동하실 수 있습니다.</em></p>
<h2 id="의존성-주입이란">의존성 주입이란<a href="#의존성-주입이란" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>이 문서에서는 의존성 주입과 제어의 역전 원칙에 대해 설명하지 않습니다. 이것들에 대해 익숙하지 않으시다면 <a href="http://fabien.potencier.org/what-is-dependency-injection.html">What is Dependency Injection?</a> by Fabien Potencier (<a href="http://symfony.com/">Symfony</a> framework 의 메인테이너) 가 작성한 글을 참고하실 수 있습니다.</p>
<h2 id="컨테이너-접근">컨테이너 접근<a href="#컨테이너-접근" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>라라벨의 컨테이너 인스턴스에 접근하는 방법은 여러가지가 있습니다. 그러나 가장 간단한 방법은 <code>app()</code> 헬퍼 메소드를 호출하는 것입니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container <span style="color:#f92672">=</span> <span style="color:#a6e22e">app</span>();
</span></span></code></pre></div><p>이 시간에는 다른 방법에 대해서는 따로 서술하지 않겠습니다. 그 대신, 컨테이너 클래스에 초점을 맞추어 보도록 하겠습니다.</p>
<p><strong>Note:</strong> 공식 문서에서는 <code>$container</code> 대신 <code>$this-&gt;app</code> 을 사용할 것입니다.</p>
<p>(* 라라벨 어플리케이션에서 이것은 실제로 Application 이라는 Container 의 서브 클래스 입니다. 그러나 이 글에서는 Container 메소드에 대해서만 설명할 것입니다.)</p>
<h3 id="외부에서-illuminatecontainer-를-사용">외부에서 Illuminate\Container 를 사용<a href="#외부에서-illuminatecontainer-를-사용" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>라라벨 외부에서 컨테이너를 사용하고 싶으신 경우, <a href="https://packagist.org/packages/illuminate/container">이것</a>을 설치하신 후, 아래와 같이 사용하실 수 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Illuminate\Container\Container</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$container <span style="color:#f92672">=</span> <span style="color:#a6e22e">Container</span><span style="color:#f92672">::</span><span style="color:#a6e22e">getInstance</span>();
</span></span></code></pre></div><h3 id="기본적인-사용법">기본적인 사용법<a href="#기본적인-사용법" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>가장 간단한 방법은 의존성 주입을 원하는 클래스의 생성자에 타입 힌트를 사용하는 것입니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyClass</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">/**
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     * @var AnotherClass
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> $dependency;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(<span style="color:#a6e22e">AnotherClass</span> $dependency)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">dependency</span> <span style="color:#f92672">=</span> $dependency;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>이후 <code>new MyClass</code> 를 사용하는 대신, 컨테이너의 <code>make()</code> 메소드를 사용합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$instance <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">MyClass</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p>컨테이너는 자동으로 의존성을 인스턴스화 할 것이며 이것은 실질적으로 아래와 동일합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$instance <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">MyClass</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">AnotherClass</span>());
</span></span></code></pre></div><p><code>AnotherClass</code> 가 다른 의존성을 가진 경우 컨테이너는 재귀적으로 의존성을 해결할 것입니다.</p>
<h3 id="실용적인-예제">실용적인 예제<a href="#실용적인-예제" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>여기 조금 더 실용적인 예제가 있습니다. (based on <a href="http://php-di.org/doc/getting-started.html">PHP-DI docs</a>)가 있습니다. - 회원 가입 기능에서 메일 기능을 분리하는 예제</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Mailer</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">mail</span>($recipient, $content)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Send an email to the recipient
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserManager</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> $mailer;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(<span style="color:#a6e22e">Mailer</span> $mailer)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">mailer</span> <span style="color:#f92672">=</span> $mailer;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">register</span>($email, $password)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Create the user account
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Send the user an email to say hello!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">mailer</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">mail</span>($email, <span style="color:#e6db74">&#39;Hello and welcome!&#39;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Illuminate\Container\Container</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$container <span style="color:#f92672">=</span> <span style="color:#a6e22e">Container</span><span style="color:#f92672">::</span><span style="color:#a6e22e">getInstance</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$userManager <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">UserManager</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>$userManager<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">register</span>(<span style="color:#e6db74">&#39;dave@davejamesmiller.com&#39;</span>, <span style="color:#e6db74">&#39;MySuperSecurePassword!&#39;</span>);
</span></span></code></pre></div><h2 id="구현-객체에-인터페이스를-바인딩-하는-법">구현 객체에 인터페이스를 바인딩 하는 법<a href="#구현-객체에-인터페이스를-바인딩-하는-법" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>컨테이너를 이용하면 인터페이스와 구현체 (Impl)를 런타임시 쉽게 인스턴스화 할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">MyInterface</span> { <span style="color:#75715e">/* ... */</span> }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">AnotherInterface</span> { <span style="color:#75715e">/* ... */</span> }
</span></span></code></pre></div><p>이후, 이 인터페이스들을 구현하는 클래스를 작성합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyClass</span> <span style="color:#66d9ef">implements</span> <span style="color:#a6e22e">MyInterface</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> $dependency;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(<span style="color:#a6e22e">AnotherInterface</span> $dependency)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">dependency</span> <span style="color:#f92672">=</span> $dependency;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>그리고 <code>bind()</code> 메소드를 사용하여 각 인터페이스를 구현체 (class)에 매핑합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bind</span>(<span style="color:#a6e22e">MyInterface</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">MyClass</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bind</span>(<span style="color:#a6e22e">AnotherInterface</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">AnotherClass</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p>마지막으로, <code>make()</code> 메소드에 클래스 이름이 아닌 인터페이스 이름을 전달합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$instance <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">MyInterface</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p><strong>Note:</strong> 만약 인터페이스 바인딩을 잊으셨다면 치명적인 오류가 발생합니다.</p>
<pre tabindex="0"><code>Fatal error: Uncaught ReflectionException: Class MyInterface does not exist
</code></pre><p>왜냐하면 컨테이너는 <code>new MyInterface</code>, 즉 인터페이스를 인스턴스화 하고자 할 것이기 때문입니다. 이것은 올바른 클래스가 아니죠.</p>
<h3 id="실용적인-예제-1">실용적인 예제<a href="#실용적인-예제-1" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>변경 가능한 캐시 레이어를 구성해보겠습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Cache</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">get</span>($key);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">put</span>($key, $value);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RedisCache</span> <span style="color:#66d9ef">implements</span> <span style="color:#a6e22e">Cache</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">get</span>($key) { <span style="color:#75715e">/* ... */</span> }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">put</span>($key, $value) { <span style="color:#75715e">/* ... */</span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Worker</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> $cache;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(<span style="color:#a6e22e">Cache</span> $cache)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">cache</span> <span style="color:#f92672">=</span> $cache;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">result</span>()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Use the cache for something...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        $result <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">cache</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;worker&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($result <span style="color:#f92672">===</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>            $result <span style="color:#f92672">=</span> <span style="color:#a6e22e">do_something_slow</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">cache</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#39;worker&#39;</span>, $result);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $result;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Illuminate\Container\Container</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$container <span style="color:#f92672">=</span> <span style="color:#a6e22e">Container</span><span style="color:#f92672">::</span><span style="color:#a6e22e">getInstance</span>();
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bind</span>(<span style="color:#a6e22e">Cache</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">RedisCache</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$result <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">Worker</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">result</span>();
</span></span></code></pre></div><h2 id="추상--구상-클래스-바인딩">추상 &amp; 구상 클래스 바인딩<a href="#추상--구상-클래스-바인딩" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>추상 클래스(abstract class) 또한 바인딩 할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bind</span>(<span style="color:#a6e22e">MyAbstract</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">MyConcreteClass</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p>또는 추상 클래스를 서브 클래스로 대체할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bind</span>(<span style="color:#a6e22e">MySQLDatabase</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">CustomMySQLDatabase</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><h2 id="커스텀-바인딩">커스텀 바인딩<a href="#커스텀-바인딩" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>만약 클래스가 추가적인 설정을 요구한다면 클래스의 이름 대신 <code>closure</code> 를 <code>bind()</code> 메소드의 두 번째 매개 변수로 넘길 수 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bind</span>(<span style="color:#a6e22e">Database</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">MySQLDatabase</span>(<span style="color:#a6e22e">MYSQL_HOST</span>, <span style="color:#a6e22e">MYSQL_PORT</span>, <span style="color:#a6e22e">MYSQL_USER</span>, <span style="color:#a6e22e">MYSQL_PASS</span>);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>매 번 데이터베이스 인터페이스가 필요할 때 마다 새로운 MySQLDatabase 인스턴스가 생성되어 사용되며, 몇 가지 미리 지정된 구성값을 필요로 합니다. (단일 인스턴스를 공유하고자 한다면, 아래 <em>싱글톤</em> 를 읽어주시기 바랍니다.)</p>
<p>클로저는 컨테이너 인스턴스를 첫 번째 매개 변수로 받으며, 필요한 경우 다른 클래스를 인스턴스화 하는 데 사용하실 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bind</span>(<span style="color:#a6e22e">Logger</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>    $filesystem <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">Filesystem</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">FileLogger</span>($filesystem, <span style="color:#e6db74">&#39;logs/error.log&#39;</span>);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>클로저는 구상 클래스가 인스턴스화 하는 법을 따로 지정할 수도 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bind</span>(<span style="color:#a6e22e">GitHub\Client</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>    $client <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">GitHub\Client</span>;
</span></span><span style="display:flex;"><span>    $client<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setEnterpriseUrl</span>(<span style="color:#a6e22e">GITHUB_HOST</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> $client;
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><h3 id="콜백-해결-컨테이너-이벤트httpslaravelkrdocs56containercontainer-events">콜백 해결 <a href="https://laravel.kr/docs/5.6/container#container-events">(컨테이너 이벤트)</a><a href="#콜백-해결-컨테이너-이벤트httpslaravelkrdocs56containercontainer-events" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>바인딩을 완벽하게 오버라이딩 하는 대신, <code>resolving()</code> 메소드를 이용하여 객체의 의존성을 해결할 때 콜백을 받으실 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">resolving</span>(<span style="color:#a6e22e">GitHub\Client</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> ($client, <span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>    $client<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setEnterpriseUrl</span>(<span style="color:#a6e22e">GITHUB_HOST</span>);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>콜백이 여러 개 존재한다면, 모든 콜백이 호출됩니다. 이 기능은 인터페이스나 추상 클래스에도 동일하게 동작합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">resolving</span>(<span style="color:#a6e22e">Logger</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Logger</span> $logger) {
</span></span><span style="display:flex;"><span>    $logger<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setLevel</span>(<span style="color:#e6db74">&#39;debug&#39;</span>);
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">resolving</span>(<span style="color:#a6e22e">FileLogger</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">FileLogger</span> $logger) {
</span></span><span style="display:flex;"><span>    $logger<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setFilename</span>(<span style="color:#e6db74">&#39;logs/debug.log&#39;</span>);
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bind</span>(<span style="color:#a6e22e">Logger</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">FileLogger</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$logger <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">Logger</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p>또한 모든 의존성 해결에 있어서 콜백을 받을 수도 있습니다 (제 생각에는 Logging / Debugging 에만 유용할 것 같습니다)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">resolving</span>(<span style="color:#66d9ef">function</span> ($object, <span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>});
</span></span></code></pre></div><h3 id="클래스-확장-바인딩-확장httpslaravelkrdocs56containerextending-bindings">클래스 확장 <a href="https://laravel.kr/docs/5.6/container#extending-bindings">(바인딩 확장)</a><a href="#클래스-확장-바인딩-확장httpslaravelkrdocs56containerextending-bindings" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p><code>extend()</code> 메소드를 사용하여 클래스를 감싸고 다른 객체로 반환시킬 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">extend</span>(<span style="color:#a6e22e">APIClient</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> ($client, <span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">APIClientDecorator</span>($client);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>반환되는 객체는 여전히 같은 인터페이스를 구현해야 합니다. 그렇지 않으면 Type hinting 에서 에러가 발생할 것입니다.</p>
<h2 id="싱글톤">싱글톤<a href="#싱글톤" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>자동 바인딩과 <code>bind()</code> 메소드를 이용하면 필요할 때마다 새로운 인스턴스가 생성됩니다 (또는 클로저가 호출됩니다). 하나의 인스턴스를 공유하고자 한다면 <code>bind()</code> 대신 <code>singleton()</code> 을 사용할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">singleton</span>(<span style="color:#a6e22e">Cache</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">RedisCache</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p>또는 클로저를 사용할 수도 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">singleton</span>(<span style="color:#a6e22e">Database</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">MySQLDatabase</span>(<span style="color:#e6db74">&#39;localhost&#39;</span>, <span style="color:#e6db74">&#39;testdb&#39;</span>, <span style="color:#e6db74">&#39;user&#39;</span>, <span style="color:#e6db74">&#39;pass&#39;</span>);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>구상 클래스를 싱글톤으로 생성하고자 한다면, 두 번째 매개 변수를 제외하고 전달합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">singleton</span>(<span style="color:#a6e22e">MySQLDatabase</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p>이 경우, 싱글톤 객체는 필요할 때 단 한 번 생성될 것입니다. 그리고 이후에는 이것을 재사용 할 것입니다. 재사용을 원하는 인스턴스가 이미 존재하는 경우, <code>instance()</code> 메소드를 사용하시기 바랍니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">instance</span>(<span style="color:#a6e22e">Container</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, $container);
</span></span></code></pre></div><h2 id="임의의-바인딩-이름">임의의 바인딩 이름<a href="#임의의-바인딩-이름" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>클래스나 인터페이스 이름 대신 임의의 문자열을 사용할 수 있습니다. 타입 힌트는 사용할 수 없으며, <code>make()</code> 메소드를 이용해야 합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bind</span>(<span style="color:#e6db74">&#39;database&#39;</span>, <span style="color:#a6e22e">MySQLDatabase</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$db <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#e6db74">&#39;database&#39;</span>);
</span></span></code></pre></div><p>인터페이스와 클래스 모두 짧은 이름 기능을 지원하려면 <code>alias()</code> 메소드를 사용해야 합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">singleton</span>(<span style="color:#a6e22e">Cache</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">RedisCache</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">alias</span>(<span style="color:#a6e22e">Cache</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#e6db74">&#39;cache&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$cache1 <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">Cache</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>$cache2 <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#e6db74">&#39;cache&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">assert</span>($cache1 <span style="color:#f92672">===</span> $cache2);
</span></span></code></pre></div><h2 id="임의의-값-저장">임의의 값 저장<a href="#임의의-값-저장" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>또한 컨테이너를 임의의 값을 저장하기 위해 사용할 수도 있습니다 (e.g. 설정 데이터)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">instance</span>(<span style="color:#e6db74">&#39;database.name&#39;</span>, <span style="color:#e6db74">&#39;testdb&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$db_name <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#e6db74">&#39;database.name&#39;</span>);
</span></span></code></pre></div><p>이 방법은 배열 접근을 지원하고 있습니다. 조금 더 자연스러운 방식이죠</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container[<span style="color:#e6db74">&#39;database.name&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;testdb&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$db_name <span style="color:#f92672">=</span> $container[<span style="color:#e6db74">&#39;database.name&#39;</span>];
</span></span></code></pre></div><p>클로저 바인딩과 같이 사용하면 왜 이것이 유용할 수 있는지 알 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">singleton</span>(<span style="color:#e6db74">&#39;database&#39;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">MySQLDatabase</span>(
</span></span><span style="display:flex;"><span>        $container[<span style="color:#e6db74">&#39;database.host&#39;</span>],
</span></span><span style="display:flex;"><span>        $container[<span style="color:#e6db74">&#39;database.name&#39;</span>],
</span></span><span style="display:flex;"><span>        $container[<span style="color:#e6db74">&#39;database.user&#39;</span>],
</span></span><span style="display:flex;"><span>        $container[<span style="color:#e6db74">&#39;database.pass&#39;</span>]
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>라라벨 자체는 컨테이너를 설정(구성)을 위해 사용하지 않습니다. 설정 파일은 <a href="https://laravel.kr/docs/5.6/configuration">Config</a> 로 분리되어 있고 설정에 대한 부분은 <a href="https://github.com/laravel/framework/blob/5.6/src/Illuminate/Config/Repository.php"><code>Illuminate\Config\Repository</code></a> 클래스에 존재합니다. 그러나 <a href="http://php-di.org/doc/php-definitions.html#values">PHP-DI</a> 는 아닙니다.</p>
<p><strong>Tip:</strong> 배열 구문은 <code>make()</code> 메소드 대신 객체를 인스턴스화 할 때 사용할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$db <span style="color:#f92672">=</span> $container[<span style="color:#e6db74">&#39;database&#39;</span>];
</span></span></code></pre></div><h2 id="함수와-메소드의-의존성-주입">함수와 메소드의 의존성 주입<a href="#함수와-메소드의-의존성-주입" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>우리는 지금까지 생성자를 통한 의존성 주입을 보았습니다. 그러나 라라벨은 함수에도 의존성 주입 기능을 제공합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">do_something</span>(<span style="color:#a6e22e">Cache</span> $cache) { <span style="color:#75715e">/* ... */</span> }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$result <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;do_something&#39;</span>);
</span></span></code></pre></div><p>추가적인 매개 변수는 순서 또는 연관 배열로 전달할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">show_product</span>(<span style="color:#a6e22e">Cache</span> $cache, $id, $tab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;details&#39;</span>) { <span style="color:#75715e">/* ... */</span> }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// show_product($cache, 1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;show_product&#39;</span>, [<span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;show_product&#39;</span>, [<span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// show_product($cache, 1, &#39;spec&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;show_product&#39;</span>, [<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;spec&#39;</span>]);
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;show_product&#39;</span>, [<span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;tab&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;spec&#39;</span>]);
</span></span></code></pre></div><p>이 기능은 Callable 메소드에 모두 적용할 수 있습니다.</p>
<h4 id="closures">Closures<a href="#closures" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$closure <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Cache</span> $cache) { <span style="color:#75715e">/* ... */</span> };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>($closure);
</span></span></code></pre></div><h4 id="static-methods">Static methods<a href="#static-methods" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SomeClass</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">staticMethod</span>(<span style="color:#a6e22e">Cache</span> $cache) { <span style="color:#75715e">/* ... */</span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>([<span style="color:#e6db74">&#39;SomeClass&#39;</span>, <span style="color:#e6db74">&#39;staticMethod&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#75715e">// or:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;SomeClass::staticMethod&#39;</span>);
</span></span></code></pre></div><h4 id="instance-methods">Instance methods<a href="#instance-methods" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostController</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">index</span>(<span style="color:#a6e22e">Cache</span> $cache) { <span style="color:#75715e">/* ... */</span> }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">show</span>(<span style="color:#a6e22e">Cache</span> $cache, $id) { <span style="color:#75715e">/* ... */</span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$controller <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">PostController</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>([$controller, <span style="color:#e6db74">&#39;index&#39;</span>]);
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>([$controller, <span style="color:#e6db74">&#39;show&#39;</span>], [<span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">1</span>]);
</span></span></code></pre></div><h3 id="인스턴스-메소드-호출을-위한-손쉬운-방법">인스턴스 메소드 호출을 위한 손쉬운 방법<a href="#인스턴스-메소드-호출을-위한-손쉬운-방법" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>클래스를 인스턴스화하고 바로 메소드를 호출하는 빠른 방법이 있습니다. <code>ClassName@methodName</code> 을 사용하는 것입니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;PostController@index&#39;</span>);
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;PostController@show&#39;</span>, [<span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">4</span>]);
</span></span></code></pre></div><p>컨테이너는 클래스를 인스턴스화하는 것에 이 기능을 사용합니다. 이것은 다음을 의미합니다</p>
<ul>
<li>의존성은 생성자를 통해 주입됩니다</li>
<li>클래스를 재사용하고자 할 때 싱글톤으로 정의할 수 있습니다</li>
<li>구상 클래스 대신 인터페이스 또는 임의의 이름을 사용할 수 있습니다</li>
</ul>
<p>예를 들어, 아래와 같은 경우가 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostController</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(<span style="color:#a6e22e">Request</span> $request) { <span style="color:#75715e">/* ... */</span> }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">index</span>(<span style="color:#a6e22e">Cache</span> $cache) { <span style="color:#75715e">/* ... */</span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">singleton</span>(<span style="color:#e6db74">&#39;post&#39;</span>, <span style="color:#a6e22e">PostController</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;post@index&#39;</span>);
</span></span></code></pre></div><p>마지막으로, 세 번째 매개 변수로 &ldquo;기본 메소드&quot;를 전달할 수 있습니다. 만약 첫번째 매개 변수가 메소드가 따로 지정되어 있지 않은 클래스 이름인 경우, 기본 메소드가 대신 호출됩니다. 라라벨은 이 기능을 이용하여 <a href="https://laravel.kr/docs/5.6/events#registering-events-and-listeners">이벤트 핸들러</a>를 구현합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#a6e22e">MyEventHandler</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, $parameters, <span style="color:#e6db74">&#39;handle&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 위와 같음
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;MyEventHandler@handle&#39;</span>, $parameters);
</span></span></code></pre></div><h3 id="메소드-호출-바인딩">메소드 호출 바인딩<a href="#메소드-호출-바인딩" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p><code>bindMethod()</code> 메소드는 메소드 호출을 오버라이드 할 수 있습니다. 예를 들어, 추가적인 매개 변수를 아래와 같이 전달할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bindMethod</span>(<span style="color:#e6db74">&#39;PostController@index&#39;</span>, <span style="color:#66d9ef">function</span> ($controller, $container) {
</span></span><span style="display:flex;"><span>    $posts <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_posts</span>(<span style="color:#f92672">...</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> $controller<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">index</span>($posts);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>이 기능은 기존의 메소드 대신 클로저를 호출하여 동작합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;PostController@index&#39;</span>);
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;PostController&#39;</span>, [], <span style="color:#e6db74">&#39;index&#39;</span>);
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>([<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">PostController</span>, <span style="color:#e6db74">&#39;index&#39;</span>]);
</span></span></code></pre></div><p>그러나 <code>call()</code> 메소드에서 추가적인 매개 변수를 전달할 수는 없습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#75715e">// 사용할 수 없음
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#39;PostController@index&#39;</span>, [<span style="color:#e6db74">&#39;Not used :-(&#39;</span>]);
</span></span></code></pre></div><p><em><strong>Notes:</strong> 이 메소드는 <a href="https://github.com/laravel/framework/blob/5.6/src/Illuminate/Contracts/Container/Container.php">컨테이너 인터페이스</a>에 존재하지 않습니다. <a href="https://github.com/laravel/framework/blob/5.6/src/Illuminate/Container/Container.php">컨테이너 클래스</a>에만 존재합니다. <a href="https://github.com/laravel/framework/pull/16800">왜 매개 변수를 무시하는지 이유는 이곳에서 확인하실 수 있습니다</a></em></p>
<h2 id="문맥에-따른-조건적-바인딩">문맥에 따른 조건적 바인딩<a href="#문맥에-따른-조건적-바인딩" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>가끔 여러분은 각각의 클래스마다 다른 구현 객체를 전달하고자 할 수도 있습니다. 다음은 <a href="https://laravel.kr/docs/5.6/container#contextual-binding">라라벨 공식 문서</a>에서 일부 수정된 예제입니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">when</span>(<span style="color:#a6e22e">PhotoController</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">needs</span>(<span style="color:#a6e22e">Filesystem</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">give</span>(<span style="color:#a6e22e">LocalFilesystem</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$container
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">when</span>(<span style="color:#a6e22e">VideoController</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">needs</span>(<span style="color:#a6e22e">Filesystem</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">give</span>(<span style="color:#a6e22e">S3Filesystem</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p><code>PhotoController</code> 와 <code>VideoController</code> 는 <code>Filesystem</code> 인터페이스에 의존적일 수 있지만, 서로 다른 구현체를 받게 됩니다. <code>bind()</code> 와 같이 <code>give()</code> 에서도 클로저를 사용할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">when</span>(<span style="color:#a6e22e">VideoController</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">needs</span>(<span style="color:#a6e22e">Filesystem</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">give</span>(<span style="color:#66d9ef">function</span> () {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Storage</span><span style="color:#f92672">::</span><span style="color:#a6e22e">disk</span>(<span style="color:#e6db74">&#39;s3&#39;</span>);
</span></span><span style="display:flex;"><span>    });
</span></span></code></pre></div><p>또는 이름(문자열)을 통해 의존성을 주입할 수도 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">instance</span>(<span style="color:#e6db74">&#39;s3&#39;</span>, $s3Filesystem);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$container
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">when</span>(<span style="color:#a6e22e">VideoController</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">needs</span>(<span style="color:#a6e22e">Filesystem</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">give</span>(<span style="color:#e6db74">&#39;s3&#39;</span>);
</span></span></code></pre></div><h3 id="기본-타입-바인딩">기본 타입 바인딩<a href="#기본-타입-바인딩" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>여러분은 또한 기본 타입들(string, integer..) 를 <code>needs()</code> 메소드를 통해 주입할 수 있습니다 (인터페이스 대신). 그리고 <code>give()</code> 메소드를 통해 값들을 전달할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">when</span>(<span style="color:#a6e22e">MySQLDatabase</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">needs</span>(<span style="color:#e6db74">&#39;$username&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">give</span>(<span style="color:#a6e22e">DB_USER</span>);
</span></span></code></pre></div><p>클로저를 통해 값이 필요할 때 까지 값을 가지고 오는 것을 늦출 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">when</span>(<span style="color:#a6e22e">MySQLDatabase</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">needs</span>(<span style="color:#e6db74">&#39;$username&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">give</span>(<span style="color:#66d9ef">function</span> () {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">config</span>(<span style="color:#e6db74">&#39;database.user&#39;</span>);
</span></span><span style="display:flex;"><span>    });
</span></span></code></pre></div><p>여기서 여러분은 클래스나 또는 의존성 이름을 사용할 수 없습니다 (e.g. <code>give('database.user')</code>). 왜냐하면, 이 값은 리터럴 값으로 반환되기 때문입니다. 대신 클로저를 사용할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">when</span>(<span style="color:#a6e22e">MySQLDatabase</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">needs</span>(<span style="color:#e6db74">&#39;$username&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">give</span>(<span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $container[<span style="color:#e6db74">&#39;database.user&#39;</span>];
</span></span><span style="display:flex;"><span>    });
</span></span></code></pre></div><h2 id="태깅-tagginghttpslaravelkrdocs56containertagging">태깅 <a href="https://laravel.kr/docs/5.6/container#tagging">(Tagging)</a><a href="#태깅-tagginghttpslaravelkrdocs56containertagging" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>컨테이너를 사용하여 관련된 바인딩을 &ldquo;태그&quot;할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tag</span>(<span style="color:#a6e22e">MyPlugin</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#e6db74">&#39;plugin&#39;</span>);
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tag</span>(<span style="color:#a6e22e">AnotherPlugin</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#e6db74">&#39;plugin&#39;</span>);
</span></span></code></pre></div><p>이후 태그가 지정된 모든 인스턴스를 배열로 받아올 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> ($container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tagged</span>(<span style="color:#e6db74">&#39;plugin&#39;</span>) <span style="color:#66d9ef">as</span> $plugin) {
</span></span><span style="display:flex;"><span>    $plugin<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">init</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>tag()</code>  메소드의 매개 변수는 배열도 사용할 수 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tag</span>([<span style="color:#a6e22e">MyPlugin</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">AnotherPlugin</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>], <span style="color:#e6db74">&#39;plugin&#39;</span>);
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tag</span>(<span style="color:#a6e22e">MyPlugin</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, [<span style="color:#e6db74">&#39;plugin&#39;</span>, <span style="color:#e6db74">&#39;plugin.admin&#39;</span>]);
</span></span></code></pre></div><h2 id="재바인딩-rebinding">재바인딩 (Rebinding)<a href="#재바인딩-rebinding" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p><em><strong>Note:</strong> 이 기능은 조금 더 고급 기능이며, 대부분의 경우 이 기능을 필요로 하지 않습니다. 원하신다면 이 부분을 넘기셔도 괜찮습니다!</em></p>
<p>바인딩 또는 인스턴스가 사용된 후 변경될 때 <code>rebinding()</code> 콜백이 호출됩니다. 예를 들어 세션 클래스가 Auth 클래스에 의해 사용된 후 변경된다면, Auth 클래스는 변경 사실을 알아야 합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">singleton</span>(<span style="color:#a6e22e">Auth</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>    $auth <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Auth</span>;
</span></span><span style="display:flex;"><span>    $auth<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setSession</span>($container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">Session</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">rebinding</span>(<span style="color:#a6e22e">Session</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> ($container, $session) <span style="color:#66d9ef">use</span> ($auth) {
</span></span><span style="display:flex;"><span>        $auth<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setSession</span>($session);
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> $auth;
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">instance</span>(<span style="color:#a6e22e">Session</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Session</span>([<span style="color:#e6db74">&#39;username&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;dave&#39;</span>]));
</span></span><span style="display:flex;"><span>$auth <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">Auth</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">echo</span> $auth<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">username</span>(); <span style="color:#75715e">// dave
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">instance</span>(<span style="color:#a6e22e">Session</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Session</span>([<span style="color:#e6db74">&#39;username&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;danny&#39;</span>]));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">echo</span> $auth<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">username</span>(); <span style="color:#75715e">// danny
</span></span></span></code></pre></div><p>재바인딩에 대해 더 자세한 내용은 <a href="https://stackoverflow.com/questions/38974593/laravels-ioc-container-rebinding-abstract-types">이곳</a>과 <a href="https://code.tutsplus.com/tutorials/digging-in-to-laravels-ioc-container--cms-22167">이곳</a>을 참고해 주시기 바랍니다.</p>
<h3 id="refresh">refresh()<a href="#refresh" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>이 기능을 더 쉽게 사용하고자 할 때, <code>refresh()</code> 메소드를 사용할 수 있습니다. 이것은 아래와 같은 일반적인 패턴을 다루고자 할 때 사용합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">singleton</span>(<span style="color:#a6e22e">Auth</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>    $auth <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Auth</span>;
</span></span><span style="display:flex;"><span>    $auth<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setSession</span>($container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">Session</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">refresh</span>(<span style="color:#a6e22e">Session</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, $auth, <span style="color:#e6db74">&#39;setSession&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> $auth;
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>또한 이 기능은 이미 존재하는 인스턴스나 바인딩을 반환하므로, 아래와 같이 코드를 작성할 수도 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">singleton</span>(<span style="color:#a6e22e">Session</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">singleton</span>(<span style="color:#a6e22e">Auth</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Container</span> $container) {
</span></span><span style="display:flex;"><span>    $auth <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Auth</span>;
</span></span><span style="display:flex;"><span>    $auth<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setSession</span>($container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">refresh</span>(<span style="color:#a6e22e">Session</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, $auth, <span style="color:#e6db74">&#39;setSession&#39;</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> $auth;
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>(개인적으로 저는 이 구문이 더 혼란스럽고 위의 좀 더 자세한 방법을 선호합니다)</p>
<p><em><strong>Notes:</strong> 이 메소드는 <a href="https://github.com/laravel/framework/blob/5.6/src/Illuminate/Contracts/Container/Container.php">컨테이너 인터페이스</a>에 존재하지 않습니다. <a href="https://github.com/laravel/framework/blob/5.6/src/Illuminate/Container/Container.php">컨테이너 클래스</a>에만 존재합니다.</em></p>
<h2 id="생성자-매개-변수-오버라이딩">생성자 매개 변수 오버라이딩<a href="#생성자-매개-변수-오버라이딩" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p><code>makeWith()</code> 메소드는 생성자 매개 변수에 추가적인 값을 전달할 수 있습니다. 기존에 존재하는 인스턴스나 싱글톤을 무시하고 종속성을 주입하면서 다른 매개 변수로 클래스의 인스턴스를 생성할 때 유용하게 사용될 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Post</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(<span style="color:#a6e22e">Database</span> $db, <span style="color:#a6e22e">int</span> $id) { <span style="color:#75715e">/* ... */</span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$post1 <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">makeWith</span>(<span style="color:#a6e22e">Post</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, [<span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>$post2 <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">makeWith</span>(<span style="color:#a6e22e">Post</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, [<span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">2</span>]);
</span></span></code></pre></div><p><em><strong>Note:</strong> 라라벨 5.3 이하에서는 간단하게 <code>make($class, $pameters)</code> 로 사용했었습니다. 라라벨 5.4에서 이 기능은 삭제되어 <code>makeWith() </code> 로 추가되었습니다. 그러나, 라라벨 5.5 에서는 다시 라라벨 5.3과 같이 사용할 수 있습니다.</em></p>
<h2 id="그-외-메소드">그 외 메소드<a href="#그-외-메소드" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>그 외 유용하다고 생각하는 모든 메소드를 다루고자 합니다. 이 내용으로 충분하지 않다면 아래 퍼블릭 메소드를 참고하실 수 있습니다.</p>
<h3 id="bound">bound()<a href="#bound" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p><code>bound()</code> 메소드는 <code>bind()</code>, <code>singleton()</code>, <code>instance()</code>, <code>alias()</code> 메소드에 의해 클래스 또는 이름(문자열)이 바운딩 되었을 때 <code>true</code> 를 반환합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bound</span>(<span style="color:#e6db74">&#39;database.user&#39;</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>배열 접근 구문과 <code>isset()</code>를 사용할 수도 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span> <span style="color:#a6e22e">isset</span>($container[<span style="color:#e6db74">&#39;database.user&#39;</span>])) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p><code>unset()</code> 함수를 통해 제거될 수 있으며, 지정된 바인딩 / 인스턴스 / 별칭을 제거합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">unset</span>($container[<span style="color:#e6db74">&#39;database.user&#39;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">var_dump</span>($container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bound</span>(<span style="color:#e6db74">&#39;database.user&#39;</span>)); <span style="color:#75715e">// false
</span></span></span></code></pre></div><h3 id="bindif">bindIf()<a href="#bindif" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p><code>bindIf()</code> 는 바인딩이 존재하지 않는 경우에만 바인딩을 하는 메소드 입니다. 동작 자체는 <code>bind()</code> 와 동일하게 동작합니다. (위의 <code>bound()</code> 참고)</p>
<p>이것은 잠재적으로 사용자의 오버라이드를 허용하여 패키지의 기본 바인딩을 등록하게끔 사용될 수 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bindIf</span>(<span style="color:#a6e22e">Loader</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">FallbackLoader</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p>그러나 <code>singletonIf()</code> 메소드는 없습니다. 대신, <code>bindIf($abstract, $concrete, true)</code> 를 통해 동일한 기능을 사용할 수 있습니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bindIf</span>(<span style="color:#a6e22e">Loader</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">FallbackLoader</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#66d9ef">true</span>);
</span></span></code></pre></div><p>또는 아래와 같은 방법도 가능합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bound</span>(<span style="color:#a6e22e">Loader</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)) {
</span></span><span style="display:flex;"><span>    $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">singleton</span>(<span style="color:#a6e22e">Loader</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>, <span style="color:#a6e22e">FallbackLoader</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="resolved">resolved()<a href="#resolved" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p><code>resolved()</code> 메소드는 의존성 문제가 이전에 해결된 경우 <code>true</code> 를 반환합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">var_dump</span>($container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">resolved</span>(<span style="color:#a6e22e">Database</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)); <span style="color:#75715e">// false
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">make</span>(<span style="color:#a6e22e">Database</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">var_dump</span>($container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">resolved</span>(<span style="color:#a6e22e">Database</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)); <span style="color:#75715e">// true
</span></span></span></code></pre></div><p>저는 이 기능이 유용할 것인지 확신하지 못하겠습니다.. <code>unset()</code> 을 사용하면 재설정이 이루어지는데 말이죠 (위의 <code>bound()</code> 참고)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">unset</span>($container[<span style="color:#a6e22e">Database</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>]);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">var_dump</span>($container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">resolved</span>(<span style="color:#a6e22e">Database</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>)); <span style="color:#75715e">// false
</span></span></span></code></pre></div><h3 id="factory">factory()<a href="#factory" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p><code>factory()</code> 메소드는 매개 변수가 존재하지 않고 <code>make()</code> 를 호출하는 클로저를 반환합니다</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$dbFactory <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">factory</span>(<span style="color:#a6e22e">Database</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$db <span style="color:#f92672">=</span> $dbFactory();
</span></span></code></pre></div><p>이 기능이 언제 쓸모가 있을 지 모르겠네요.</p>
<h3 id="wrap">wrap()<a href="#wrap" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p><code>wrap()</code> 메소드는 클로저가 실행될 때 종속성이 주입되도록 클로저를 래핑합니다. wrap 메소드는 매개 변수 배열을 사용할 수 있으며 반환된 클로저에는 매개 변수가 없습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>$cacheGetter <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">Cache</span> $cache, $key) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> $cache<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">get</span>($key);
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$usernameGetter <span style="color:#f92672">=</span> $container<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">wrap</span>($cacheGetter, [<span style="color:#e6db74">&#39;username&#39;</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$username <span style="color:#f92672">=</span> $usernameGetter();
</span></span></code></pre></div><p>이 기능이 언제 쓸모가 있을 지 모르겠네요. (2)</p>
<p><em><strong>Note:</strong> 이 메소드는 <a href="https://github.com/laravel/framework/blob/5.6/src/Illuminate/Contracts/Container/Container.php">컨테이너 인터페이스</a>에 존재하지 않습니다. <a href="https://github.com/laravel/framework/blob/5.6/src/Illuminate/Container/Container.php">컨테이너 클래스</a>에만 존재합니다.</em></p>
<h3 id="afterresolving">afterResolving()<a href="#afterresolving" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p><code>afterResolving()</code> 은 <code>resolving()</code> 콜백 후에 <code>afterResolving()</code> 콜백을 호출한다는 점을 제외하면 <code>resolving()</code> 과 동일합니다. 이 기능이 언제 쓸모가 있을 지 모르겠네요.</p>
<h3 id="마지막으로">마지막으로..<a href="#마지막으로" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<ul>
<li><code>isShared()</code> : 주어진 타입이 공유된 싱글톤인지 인스턴스인지 알아냅니다.</li>
<li><code>isAlias()</code> : 주어진 문자열이 등록된 별칭(alias)인지 알아냅니다.</li>
<li><code>hasMethodBinding()</code> : 컨테이너가 주어진 바인딩을 가지고 있는지 알아냅니다.</li>
<li><code>getBindings()</code> : 등록된 모든 바인딩을 원시 배열의 형태로 가져옵니다.</li>
<li><code>getAlias($abstract)</code> : 기본 클래스와 바인딩 이름에 대한 별칭을 해결(Resolves) 합니다.</li>
<li><code>forgetInstance($abstract)</code> : 단일 인스턴스 객체(싱글톤)를 지웁니다.</li>
<li><code>forgetInstances()</code> 모든 인스턴스 객체를 지웁니다.</li>
<li><code>flush()</code> : 모든 바인딩과 인스턴스를 지우고 컨테이너를 리셋합니다 (effectively resetting the container).</li>
<li><code>setInstance()</code> : <code>getInstance()</code> 에서 사용된 인스턴스를 대체합니다. (Tip: <code>setInstance(null)</code> 을 이용해서 이것을 지우면 다음에 새로운 인스턴스가 생성됩니다.)</li>
</ul>
<p><em><strong>Note:</strong> 마지막 부분의 메소드들은 <a href="https://github.com/laravel/framework/blob/5.6/src/Illuminate/Contracts/Container/Container.php">컨테이너 인터페이스</a>의 일부가 아닙니다.</em></p>
<hr>
<ul>
<li>이 문서의 원본은 2017년 06월 15일에 DaveJamesMiller.com 에서 포스팅되었습니다.</li>
<li>이 문서는 원작자의 허가를 받아 번역되었습니다. Dave &lt;<a href="mailto:dave%40davejamesmiller.com">dave@davejamesmiller.com</a>&gt;. 감사합니다.</li>
<li>이 문서는 <a href="https://github.com/hwajin-me">Hwajin Lee &laquo;brightdelusion@gmail.com&raquo;</a> 가 번역하였습니다.</li>
</ul>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">Read other posts</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="http://localhost:1313/ja/posts/2022/05/06/design-and-management-of-aggregate-root-ddd/" class="button inline prev">
        ドメイン駆動設計のAggregate Rootを設計&amp;維持する方法論
      </a>
    
    
    
  </div>
</div>


  

  
    <div class="comment">
   <div class="comment__title">
     <span class="comment__title-h">COMMENTS</span>
     <hr />
   </div>
  </div>
  <script src="https://giscus.app/client.js"
    data-repo="hwajin-me/blog.hwajin.me"
    data-repo-id="MDEwOlJlcG9zaXRvcnkyNDUzNTI0Mjk="
    data-category="General"
    data-category-id="DIC_kwDODp_H7c4COW6Q"
    data-mapping="pathname"
    data-reactions-enabled="1"
    data-emit-metadata="1"
    data-input-position="bottom"
    data-theme="dark_high_contrast"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>
  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2024 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
